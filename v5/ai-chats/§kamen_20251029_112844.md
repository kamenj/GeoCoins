Â§kamen_20251029_112844

# Full Screen Mode Implementation - Button Visibility and Styling

## User Request
Add a 'Full Screen' button in the MenuBottom for the MapPoints content view that shows MapPoints + MenuBottom docked fully on screen, with proper button visibility management.

## Changes Made

### 1. Fixed MenuBottom Header Visibility in Fullscreen
**File: `v5/index.css`**
- Changed `#menuBottom-header` from `display: none !important;` to `display: flex !important;` in fullscreen mode
- Removed aggressive CSS overrides for buttons (colors, padding, positioning) to maintain consistent styling between normal and fullscreen modes
- Kept minimal CSS to ensure header and content are visible in fullscreen:
  ```css
  body.fullscreen-mode > #menuBottom #menuBottom-header {
    display: flex !important;
  }
  body.fullscreen-mode > #menuBottom .section-content {
    display: block !important;
  }
  ```

### 2. Removed Button Re-creation in Fullscreen Mode
**File: `v5/app.js` - `enterMapPointsFullScreen()` function**
- Removed `renderMenusFor()` call that was recreating buttons
- Removed all console.log debugging statements
- Removed fallback manual button creation logic
- Simplified to just move menuBottom to body and enter browser fullscreen
- Added `renderMenusFor()` call AFTER moving menuBottom to update button visibility (show/hide Full Screen button)

### 3. Made Cancel Button Exit Fullscreen
**File: `v5/app.js` - Points Cancel command**
- Modified Cancel button action to check if in fullscreen mode:
  ```javascript
  action: function () {
    if (State.fullScreen.active) {
      exitMapPointsFullScreen();
    } else {
      showContent(null);
    }
  }
  ```

### 4. Removed Exit Full Screen Button
**File: `v5/app.js`**
- Removed "Exit Full Screen" button definition from Commands.LIST
- Removed `PointsExitFullScreen: "points.exitFullScreen"` constant
- Removed from allowed commands list for non-logged-in users
- Now using Cancel button to exit fullscreen mode instead

### 5. Full Screen Button Visibility Logic
**File: `v5/app.js` - Points Full Screen command**
- Button already had proper visibility function:
  ```javascript
  visible: function() {
    return !State.fullScreen.active;
  }
  ```
- This hides the Full Screen button when already in fullscreen mode
- Re-rendering menus on enter/exit fullscreen ensures visibility is updated

## Implementation Details

### Fullscreen Mode Flow
1. User clicks "Full Screen" button
2. `enterMapPointsFullScreen()` executes:
   - Saves current state (scroll position, visible sections, menuBottom parent)
   - Sets `State.fullScreen.active = true`
   - Adds `fullscreen-mode` CSS class to body
   - Hides all sections except MapPoints
   - Moves menuBottom to body level
   - Re-renders menus (Full Screen button hides)
   - Enters browser fullscreen API
3. User clicks "Cancel" button
4. `exitMapPointsFullScreen()` executes:
   - Exits browser fullscreen
   - Restores menuBottom to original parent
   - Sets `State.fullScreen.active = false`
   - Removes `fullscreen-mode` CSS class
   - Restores previously visible sections
   - Re-renders menus (Full Screen button shows again)

### Key Design Decisions
- **Reuse existing buttons**: Don't create new buttons in fullscreen, just reuse the same buttons from normal mode
- **Consistent styling**: Buttons look identical in both modes (removed all fullscreen-specific styling overrides)
- **Cancel exits fullscreen**: More intuitive than having a separate "Exit Full Screen" button
- **Minimal CSS changes**: Only make header/content visible, don't override button styles

## Testing Notes
- Full Screen button appears in normal mode
- Full Screen button hides when entering fullscreen mode
- Cancel button exits fullscreen mode when in fullscreen
- Cancel button hides content when not in fullscreen (original behavior)
- Buttons maintain same appearance and positioning in both modes
- MenuBottom properly displays with all buttons in fullscreen mode
